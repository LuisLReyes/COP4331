<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Login</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
         <script src="cookie.js"></script>
	<!--bootstrap-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
       
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script> <!--out?-->
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script> <!--out?-->
        
	
	<script>
        $.fn.serializeObject = function(){
            
            var o = {};
            var a = this.serializeArray();
            $.each(a, function() {
                   if (o[this.name] !== undefined) {
                   if (!o[this.name].push) {
                   o[this.name] = [o[this.name]];
                   }
                   o[this.name].push(this.value || '');
                   } else {
                   o[this.name] = this.value || '';
                   }
                   });
                   return o;
        };
		 function validateForm2() {
                 //for login
                 // console.log("testing");
                  var first= document.forms["first"]["UserName"].value;
                  var second = document.forms["first"]["passwordHash"].value;
                  var first2 = first ;
                  var first3 = second;
                  console.log(first2);
                  console.log(first3);
                  var name = first2;
                  var obj = {};
                  obj[name] = first2;
                  var name2 = second;
                  obj[name2] = second;
                  
                  var form_data=JSON.stringify({"UserName": name,
                                               "passwordHash" : name2
                                               });
                  console.log(form_data);
                                                   
                 
                  // submit form data to api
                  $.ajax({
                          url: "https://hammerfall.xyz/API-Files/api/User/login.php",
                         type : "POST",
                         contentType : 'application/json',
                         data : form_data,
                         success : function(result){
                         console.log("I seem to get here but");
				 
				 
				 
				 
				 
		        setCookie('token', result.token, 1);
                         // store jwt to cookie
                       //  setCookie("token", result.token, 1);
                         
                         // show home page & tell the user it was a successful login
                       //  showHomePage();
                        
                         location = 'contacts.html';
                         
                         },
                         error: function(xhr, resp, text){
                         console.log("NOPE!");
				  alert("login credentials wrong");
                         // on error, tell the user login has failed & empty the input boxes
                         $('#response').html("<div class='alert alert-danger'>Login failed. Email or password is incorrect.</div>");
                         
                         }
                         });
                         
                         return false;
                  
                  
                }
				
		//function for create user
		function validateForm3() {
                 // console.log("testing");
                  var first= document.forms["myForm"]["inputUsername"].value;
                  var second = document.forms["myForm"]["inputPassword"].value;
				  var third = document.forms["myForm"]["FirstName"].value;
				  var fourth = document.forms["myForm"]["LastName"].value;
                  var first2 = first ;
                  var first3 = second;
		  var first4 = third;
		  var first5 = fourth;
                  console.log(first2);
                  console.log(first3);
		  console.log(first4);
		  console.log(first5);
                  var name = first2;
                  var obj = {};
                  obj[name] = first2;
                  var name2 = second;
                  obj[name2] =second;
		  var name3 = third;
                  obj[name2] = third;
		  var name4 = fourth;
                  obj[name2] = fourth;
                  
                  var form_data=JSON.stringify({"UserName": name,
                                               "passwordHash" : name2,
					       "FirstName" : name3,
					        "LastName" : name4
                                               });
                  console.log(form_data);
                                                   
                 
                  // submit form data to api
                  $.ajax({
                          url: "https://www.hammerfall.xyz/API-Files/api/User/createUser.php",
                         type : "POST",
                         contentType : 'application/json',
                         data : form_data,
                         success : function(result){
                         console.log("I seem to get here but");
                         // store jwt to cookie
                       //  setCookie("token", result.token, 1);
                         
                         // show home page & tell the user it was a successful login
                       //  showHomePage();
                         alert("Account Creation SUCCSSFULLL. Please login!");
                         location = 'index.html';
                         
                         },
                         error: function(xhr, resp, text){
		           alert("username exists already");
                         console.log("NOPE!");
                         // on error, tell the user login has failed & empty the input boxes
                         $('#response').html("<div class='alert alert-danger'>Login failed. Email or password is incorrect.</div>");
                         
                         }
                         });
                         
                         return false;
                  
                  
                }
				
    
        </script>
	
  </head>
  <body>
    <section id="overlay">
	<br>
	<br>
	<br>
	  <img src="title.jpg" alt="Logo" id="title">
      <img src="knights.jpg" alt="Logo" id="logo">
	  <br>
			
	<!--Log in form-->
    
    <!-- This sends us to the next form-->
    
     <!-- <form action="contacts.html" method="GET" id="loginpg"> -->
    <form name="first"  id="first" onsubmit="return validateForm2()" method="post">
        <label for="UserName">Username:</label>
		<input id="UserName" name="UserName" type="text" required minlength="3" maxlength="15" pattern="[a-zA-Z0-9]+">
		<br>
        <label for="passwordHash">Password:</label>
        <input id="passwordHash" name="passwordHash" type="password" required minlength="4" maxlength="15">
		<br>
		
		<!--input type ="button" onclick="CreateAccount(this.form)"value="Signup"/-->
        <!--input type="submit" value="Submit"-->
        <button type='submit' class="btn btn-primary" id="button-style" >Login</button>
		
		<!-- Create Account Button -->
        <button type="button" data-toggle="modal" data-target="#exampleModal" id="button-style" class="btn btn-primary">
        CreateAccount
        </button>
      </form>
	  <br>
	  
	  	<!-- Create New Account Popup -->
        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
        </div>
        <div class="modal-body">
		<!--Creat New Account Form-->
                <form name="myForm" id="myForm" onsubmit="return validateForm3()" method="post">
                        <div class="form-group">
                          <label for="inputUsername">Username</label>
                          <input type="text" class="form-control" id="inputUsername" name="inputUsername" aria-describedby="usernameHelp" placeholder="Enter Username" name="Username" required minlength="3" maxlength="15" pattern="[a-zA-Z0-9]+">
                        </div>

                        <div class="form-group">
                          <label for="inputPassword">Password</label>
                          <input type="password" class="form-control" id="inputPassword" name="inputPassword" placeholder="Enter Password" name="Password" required minlength="8" maxlength="15">
                        </div>
                        <div class="form-group">
                            <label for="FirstName">Firstname</label>
                            <input type="text" class="form-control" name="FirstName" id="FirstName" placeholder="Enter First Name" required />
                        </div>
                        
                        <div class="form-group">
                            <label for="LastName">Lastname</label>
                            <input type="text" class="form-control" name="LastName" id="LastName" placeholder="Enter Last Name" required />
                        </div>

                        <div class="modal-footer">
                            <button type="button" data-dismiss="modal" class="btn btn-primary">Cancel</button>
                            <input type="submit" id="button-style" value="Create" class="btn btn-primary">
                        </div>
                </form>
                
                
               
                
        </div>
			</div>
			</div>
		</div>
	  
	  
	  
    </section>
  </body>
</html>
